<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVADA CRM | Sistema de Gest√£o</title>
    <link rel="stylesheet" href="css/crm-style.css">
    <link rel="stylesheet" href="css/deadline-alerts.css">
    <link rel="stylesheet" href="css/kanban-board.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <!-- ==========================================
       LOGIN PAGE
       ========================================== -->
    <div id="login-page" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-car-side"></i>
                </div>
                <h1 class="login-title">AVADA CRM</h1>
                <p class="login-subtitle">Sistema de Gest√£o para Profissionais</p>
            </div>

            <div class="error-message" id="login-error"></div>

            <form id="login-form">
                <div class="form-group">
                    <label class="form-label">E-mail</label>
                    <input type="email" id="login-email" class="form-input" placeholder="seu@email.com" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" id="login-password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>

                <button type="submit" class="btn-login">
                    <span id="login-btn-text">Entrar</span>
                    <span id="login-loading" class="loading hidden"></span>
                </button>
            </form>

            <p style="text-align: center; margin-top: 20px; color: #718096; font-size: 0.9rem;">
                Acesso restrito a profissionais autorizados
            </p>
        </div>
    </div>

    <!-- ==========================================
       DASHBOARD
       ========================================== -->
    <div id="dashboard-page" class="dashboard hidden">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-car-side"></i> AVADA CRM
                </div>
                <div class="sidebar-user">
                    <div class="sidebar-user-name" id="user-name">Carregando...</div>
                    <div class="sidebar-user-role" id="user-role"></div>
                </div>
            </div>

            <nav class="sidebar-menu" id="sidebar-menu">
                <div class="menu-item active" data-view="dashboard">
                    <span class="menu-icon"><i class="fas fa-chart-line"></i></span>
                    <span>Dashboard</span>
                </div>
                <div class="menu-item" data-view="clients">
                    <span class="menu-icon"><i class="fas fa-users"></i></span>
                    <span>Clientes</span>
                </div>
                <div class="menu-item" data-view="processes">
                    <span class="menu-icon"><i class="fas fa-folder-open"></i></span>
                    <span>Processos Ativos</span>
                </div>
                <div class="menu-item" data-view="archived" onclick="switchView('archived')">
                    <span class="menu-icon"><i class="fas fa-archive"></i></span>
                    <span>Arquivados</span>
                </div>
                <div class="menu-item" onclick="window.open('calculadora.html', '_blank')" style="cursor: pointer;">
                    <span class="menu-icon"><i class="fas fa-calculator"></i></span>
                    <span>Calculadora de Prazos</span>
                </div>
                <div class="menu-item" onclick="window.open('consulta-veicular.html', '_blank')"
                    style="cursor: pointer;">
                    <span class="menu-icon"><i class="fas fa-car"></i></span>
                    <span>Consulta Veicular</span>
                </div>
                <div class="menu-item admin-only hidden" data-view="system-info">
                    <span class="menu-icon"><i class="fas fa-info-circle"></i></span>
                    <span>Informa√ß√µes do Sistema</span>
                </div>
                <div class="menu-item admin-only hidden" data-view="users">
                    <span class="menu-icon"><i class="fas fa-user-cog"></i></span>
                    <span>Usu√°rios</span>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="menu-item" onclick="openChangePasswordModal()"
                    style="cursor: pointer; margin-bottom: 10px;">
                    <span class="menu-icon"><i class="fas fa-key"></i></span>
                    <span>Alterar Senha</span>
                </div>
                <button class="btn-logout" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="topbar">
                <h1 class="topbar-title" id="page-title">Dashboard</h1>
            </div>

            <div class="content-area" id="content-area">
                <!-- Dynamic content loaded here -->
            </div>
        </main>
    </div>

    <!-- ==========================================
       MODALS
       ========================================== -->

    <!-- Client Modal -->
    <div id="client-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="client-modal-title">Novo Cliente</h2>
                <button class="modal-close" onclick="closeClientModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="client-form">
                    <input type="hidden" id="client-id">
                    <div class="form-group">
                        <label class="form-label">Nome *</label>
                        <input type="text" id="client-name" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">E-mail</label>
                        <input type="email" id="client-email" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telefone *</label>
                        <input type="tel" id="client-phone" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">CPF</label>
                        <input type="text" id="client-cpf" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Endere√ßo</label>
                        <input type="text" id="client-address" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Observa√ß√µes</label>
                        <textarea id="client-notes" class="form-input" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo de Cliente *</label>
                        <select id="client-partnership" class="form-input" required>
                            <option value="">Selecione...</option>
                            <option value="PARTICULAR">Particular</option>
                            <option value="AVADA">Parceria AVADA</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeClientModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="saveClient()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE VISUALIZA√á√ÉO COMPLETA DE PROCESSO -->
    <div id="process-view-modal" class="modal">
        <div class="modal-content" style="max-width: 90%; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 class="modal-title">Detalhes Completos do Processo</h2>
                <button class="modal-close" onclick="closeProcessViewModal()">√ó</button>
            </div>
            <div class="modal-body" style="padding: 30px;">
                <!-- Processo Info -->
                <div style="background: #f7fafc; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: #2d3748; font-size: 1.25rem;">üìã Informa√ß√µes do Processo</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div><strong>N¬∫ do Processo ou AIT:</strong> <span id="view-case-number"></span></div>
                        <div><strong>Cliente:</strong> <span id="view-client-name"></span></div>
                        <div><strong>Categoria:</strong> <span id="view-category"></span></div>
                        <div><strong>Fase:</strong> <span id="view-phase"></span></div>
                        <div><strong>Status:</strong> <span id="view-status"></span></div>
                        <div><strong>Prazo:</strong> <span id="view-deadline"></span></div>
                    </div>
                </div>

                <!-- Location Info -->
                <div style="background: #edf2f7; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: #2d3748; font-size: 1.25rem;">üìç Localiza√ß√£o e Jurisdi√ß√£o</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div><strong>Estado:</strong> <span id="view-state"></span></div>
                        <div><strong>Cidade:</strong> <span id="view-city"></span></div>
                        <div><strong>Tribunal:</strong> <span id="view-court"></span></div>
                        <div><strong>√ìrg√£o de Tr√¢nsito:</strong> <span id="view-agency"></span></div>
                    </div>
                </div>

                <!-- Description -->
                <div style="margin-bottom: 20px;">
                    <h3 style="margin: 0 0 10px 0; color: #2d3748; font-size: 1.25rem;">üìù Descri√ß√£o</h3>
                    <div id="view-description"
                        style="background: #fff; border: 1px solid #e2e8f0; padding: 15px; border-radius: 6px; min-height: 60px;">
                    </div>
                </div>

                <!-- Observations -->
                <div style="margin-bottom: 20px;">
                    <h3 style="margin: 0 0 10px 0; color: #2d3748; font-size: 1.25rem;">üí° Observa√ß√µes</h3>
                    <textarea id="view-observations" class="form-input" rows="4"
                        placeholder="Adicione observa√ß√µes sobre o processo..."></textarea>
                </div>

                <!-- Lawyer Requests -->
                <div style="margin-bottom: 20px;">
                    <h3 style="margin: 0 0 10px 0; color: #2d3748; font-size: 1.25rem;">‚öñÔ∏è Requisi√ß√µes ao Advogado</h3>
                    <textarea id="view-lawyer-requests" class="form-input" rows="4"
                        placeholder="Adicione requisi√ß√µes espec√≠ficas para o advogado..."></textarea>
                </div>

                <!-- Dates -->
                <div style="background: #f0fff4; padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <h3 style="margin: 0 0 10px 0; color: #2d3748; font-size: 1rem;">üïê Datas</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; font-size: 0.9rem;">
                        <div><strong>Criado em:</strong> <span id="view-created-at"></span></div>
                        <div><strong>Atualizado em:</strong> <span id="view-updated-at"></span></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="display: flex; justify-content: space-between;">
                <button class="btn btn-secondary" onclick="closeProcessViewModal()">Fechar</button>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="saveProcessObservations()">
                        <i class="fas fa-save"></i> Salvar Observa√ß√µes
                    </button>
                    <button class="btn btn-success" onclick="editProcessFromView()">
                        <i class="fas fa-edit"></i> Editar Processo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Process Modal -->
    <div id="process-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="process-modal-title">Novo Processo</h2>
                <button class="modal-close" onclick="closeProcessModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="process-form">
                    <input type="hidden" id="process-id">
                    <input type="hidden" id="process-partnership" value="AVADA">
                    <div class="form-group">
                        <label class="form-label">Cliente *</label>
                        <select id="process-client" class="form-input" required>
                            <option value="">Selecione...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">N¬∫ do Processo ou AIT *</label>
                        <input type="text" id="process-case-number" class="form-input" required>
                    </div>

                    <!-- CATEGORIA DE PROCESSO -->
                    <div class="form-group">
                        <label class="form-label">Categoria de Processo *</label>
                        <select id="process-category" class="form-input" required>
                            <option value="">Selecione...</option>
                            <option value="C√≠vel (Comum)">1. C√≠vel (Comum)</option>
                            <option value="Tr√¢nsito Judicial">2. Tr√¢nsito Judicial</option>
                            <option value="Tr√¢nsito Administrativo">3. Tr√¢nsito Administrativo</option>
                            <option value="Tr√¢nsito Administrativo + Judicial">4. Tr√¢nsito Administrativo + Judicial
                            </option>
                            <option value="Per√≠cia em Acidente de Tr√¢nsito">5. Per√≠cia em Acidente de Tr√¢nsito</option>
                            <option value="Per√≠cia em Documentos">6. Per√≠cia em Documentos</option>
                            <option value="Per√≠cia Calculista">7. Per√≠cia Calculista</option>
                            <option value="An√°lise Contrato Financiamento">8. An√°lise Contrato Financiamento</option>
                            <option value="An√°lise Contrato Empr√©stimo Consignado">9. An√°lise Contrato Empr√©stimo
                                Consignado</option>
                            <option value="An√°lise Contrato Trabalhista">10. An√°lise Contrato Trabalhista</option>
                            <option value="An√°lise Previdenci√°rio">11. An√°lise Previdenci√°rio</option>
                        </select>
                    </div>

                    <!-- FASE PROCESSUAL -->
                    <div class="form-group">
                        <label class="form-label">Fase Processual *</label>
                        <select id="process-phase" class="form-input" required>
                            <option value="">Selecione...</option>
                            <option value="Defesa de Autua√ß√£o">1. Defesa de Autua√ß√£o</option>
                            <option value="Recurso √† JARI">2. Recurso √† JARI</option>
                            <option value="Recurso ao CETRAN">3. Recurso ao CETRAN</option>
                            <option value="Recurso ao Colegiado da JARI">4. Recurso ao Colegiado da JARI</option>
                            <option value="Peti√ß√£o Inicial">5. Peti√ß√£o Inicial</option>
                            <option value="Embargos de Declara√ß√£o">6. Embargos de Declara√ß√£o</option>
                            <option value="Recurso Inominado">7. Recurso Inominado</option>
                            <option value="Recurso em Agravo de Instrumento">8. Recurso em Agravo de Instrumento
                            </option>
                            <option value="Recurso Especial">9. Recurso Especial</option>
                            <option value="Pedido de Uniformiza√ß√£o de Jurisprud√™ncias">10. Pedido de Uniformiza√ß√£o de
                                Jurisprud√™ncias</option>
                            <option value="Recurso Extraordin√°rio">11. Recurso Extraordin√°rio</option>
                            <option value="R√©plica √† Contesta√ß√£o">12. R√©plica √† Contesta√ß√£o</option>
                            <option value="Cumprimento de Senten√ßa">13. Cumprimento de Senten√ßa</option>
                            <option value="Manifesta√ß√£o">14. Manifesta√ß√£o</option>
                            <option value="Emenda √† Inicial">15. Emenda √† Inicial</option>
                            <option value="Pedido de Autotutela">16. Pedido de Autotutela</option>
                            <option value="Parecer T√©cnico">17. Parecer T√©cnico</option>
                            <option
                                value="Pedido de Uniformiza√ß√£o de Jurisprud√™ncias (sempre solicite gratuidade de justi√ßa)">
                                10. Pedido de Uniformiza√ß√£o de Jurisprud√™ncias (sempre solicite gratuidade de justi√ßa)
                            </option>
                            <option value="Recurso Extraordin√°rio (sempre solicite gratuidade de justi√ßa)">11. Recurso
                                Extraordin√°rio (sempre solicite gratuidade de justi√ßa)</option>
                            <option value="R√©plica √† Contesta√ß√£o (sempre reforce o pedido de gratuidade de justi√ßa)">12.
                                R√©plica √† Contesta√ß√£o (sempre reforce o pedido de gratuidade de justi√ßa)</option>
                            <option value="Cumprimento de Senten√ßa">13. Cumprimento de Senten√ßa</option>
                            <option value="Manifesta√ß√£o (sempre reforce o pedido de gratuidade de justi√ßa)">14.
                                Manifesta√ß√£o (sempre reforce o pedido de gratuidade de justi√ßa)</option>
                            <option value="Emenda √† Inicial (sempre reforce o pedido de gratuidade de justi√ßa)">16.
                                Emenda √† Inicial (sempre reforce o pedido de gratuidade de justi√ßa)</option>
                            <option value="Pedido de Autotutela">17. Pedido de Autotutela</option>
                        </select>
                    </div>

                    <!-- √ìRG√ÉO DE TR√ÇNSITO -->
                    <div class="form-group">
                        <label class="form-label">√ìrg√£o de Tr√¢nsito</label>
                        <select id="process-agency" class="form-input" onchange="toggleOtherField('agency')">
                            <option value="">Selecione...</option>
                            <optgroup label="Nacional">
                                <option value="CONTRAN">CONTRAN</option>
                                <option value="DENATRAN">DENATRAN/SENATRAN</option>
                                <option value="PRF">PRF - Pol√≠cia Rodovi√°ria Federal</option>
                                <option value="DNIT">DNIT</option>
                            </optgroup>
                            <optgroup label="Estaduais (DETRAN)">
                                <option value="DETRAN-AC">DETRAN-AC</option>
                                <option value="DETRAN-AL">DETRAN-AL</option>
                                <option value="DETRAN-AP">DETRAN-AP</option>
                                <option value="DETRAN-AM">DETRAN-AM</option>
                                <option value="DETRAN-BA">DETRAN-BA</option>
                                <option value="DETRAN-CE">DETRAN-CE</option>
                                <option value="DETRAN-DF">DETRAN-DF</option>
                                <option value="DETRAN-ES">DETRAN-ES</option>
                                <option value="DETRAN-GO">DETRAN-GO</option>
                                <option value="DETRAN-MA">DETRAN-MA</option>
                                <option value="DETRAN-MT">DETRAN-MT</option>
                                <option value="DETRAN-MS">DETRAN-MS</option>
                                <option value="DETRAN-MG">DETRAN-MG</option>
                                <option value="DETRAN-PA">DETRAN-PA</option>
                                <option value="DETRAN-PB">DETRAN-PB</option>
                                <option value="DETRAN-PR">DETRAN-PR</option>
                                <option value="DETRAN-PE">DETRAN-PE</option>
                                <option value="DETRAN-PI">DETRAN-PI</option>
                                <option value="DETRAN-RJ">DETRAN-RJ</option>
                                <option value="DETRAN-RN">DETRAN-RN</option>
                                <option value="DETRAN-RS">DETRAN-RS</option>
                                <option value="DETRAN-RO">DETRAN-RO</option>
                                <option value="DETRAN-RR">DETRAN-RR</option>
                                <option value="DETRAN-SC">DETRAN-SC</option>
                                <option value="DETRAN-SP">DETRAN-SP</option>
                                <option value="DETRAN-SE">DETRAN-SE</option>
                                <option value="DETRAN-TO">DETRAN-TO</option>
                            </optgroup>
                            <optgroup label="Municipais (Capitais)">
                                <option value="AMC Fortaleza">AMC - Fortaleza</option>
                                <option value="CET S√£o Paulo">CET - S√£o Paulo</option>
                                <option value="CET-Rio">CET-Rio</option>
                                <option value="Transalvador">Transalvador</option>
                                <option value="EPTC Porto Alegre">EPTC - Porto Alegre</option>
                                <option value="BHTrans">BHTrans - Belo Horizonte</option>
                                <option value="Manaustrans">Manaustrans</option>
                            </optgroup>
                            <optgroup label="Outros">
                                <option value="DER">DER - Departamento de Estradas de Rodagem</option>
                                <option value="JARI">JARI (Gen√©rico)</option>
                                <option value="CETRAN">CETRAN (Gen√©rico)</option>
                                <option value="Outro">Outro (Especificar)</option>
                            </optgroup>
                        </select>
                        <input type="text" id="process-agency-other" class="form-input mt-2" style="display: none;"
                            placeholder="Especifique o √ìrg√£o...">
                    </div>

                    <!-- ESTADO -->
                    <div class="form-group">
                        <label class="form-label">Estado (UF) *</label>
                        <select id="process-state" class="form-input" required onchange="loadCitiesByState()">
                            <option value="">Selecione...</option>
                            <option value="AC">Acre (AC)</option>
                            <option value="AL">Alagoas (AL)</option>
                            <option value="AP">Amap√° (AP)</option>
                            <option value="AM">Amazonas (AM)</option>
                            <option value="BA">Bahia (BA)</option>
                            <option value="CE">Cear√° (CE)</option>
                            <option value="DF">Distrito Federal (DF)</option>
                            <option value="ES">Esp√≠rito Santo (ES)</option>
                            <option value="GO">Goi√°s (GO)</option>
                            <option value="MA">Maranh√£o (MA)</option>
                            <option value="MT">Mato Grosso (MT)</option>
                            <option value="MS">Mato Grosso do Sul (MS)</option>
                            <option value="MG">Minas Gerais (MG)</option>
                            <option value="PA">Par√° (PA)</option>
                            <option value="PB">Para√≠ba (PB)</option>
                            <option value="PR">Paran√° (PR)</option>
                            <option value="PE">Pernambuco (PE)</option>
                            <option value="PI">Piau√≠ (PI)</option>
                            <option value="RJ">Rio de Janeiro (RJ)</option>
                            <option value="RN">Rio Grande do Norte (RN)</option>
                            <option value="RS">Rio Grande do Sul (RS)</option>
                            <option value="RO">Rond√¥nia (RO)</option>
                            <option value="RR">Roraima (RR)</option>
                            <option value="SC">Santa Catarina (SC)</option>
                            <option value="SP">S√£o Paulo (SP)</option>
                            <option value="SE">Sergipe (SE)</option>
                            <option value="TO">Tocantins (TO)</option>
                        </select>
                    </div>

                    <!-- CIDADE -->
                    <div class="form-group">
                        <label class="form-label">Cidade/Comarca *</label>
                        <select id="process-city" class="form-input" required>
                            <option value="">Selecione primeiro o Estado</option>
                        </select>
                    </div>

                    <!-- TRIBUNAL -->
                    <div class="form-group">
                        <label class="form-label">Tribunal</label>
                        <select id="process-court" class="form-input" onchange="toggleOtherField('court')">
                            <option value="">Selecione...</option>
                            <optgroup label="Tribunais Superiores">
                                <option value="STF">STF - Supremo Tribunal Federal</option>
                                <option value="STJ">STJ - Superior Tribunal de Justi√ßa</option>
                            </optgroup>
                            <optgroup label="Tribunais Regionais Federais">
                                <option value="TRF1">TRF da 1¬™ Regi√£o</option>
                                <option value="TRF2">TRF da 2¬™ Regi√£o</option>
                                <option value="TRF3">TRF da 3¬™ Regi√£o</option>
                                <option value="TRF4">TRF da 4¬™ Regi√£o</option>
                                <option value="TRF5">TRF da 5¬™ Regi√£o</option>
                                <option value="TRF6">TRF da 6¬™ Regi√£o</option>
                            </optgroup>
                            <optgroup label="Tribunais de Justi√ßa Estaduais">
                                <option value="TJAC">TJAC - Acre</option>
                                <option value="TJAL">TJAL - Alagoas</option>
                                <option value="TJAP">TJAP - Amap√°</option>
                                <option value="TJAM">TJAM - Amazonas</option>
                                <option value="TJBA">TJBA - Bahia</option>
                                <option value="TJCE">TJCE - Cear√°</option>
                                <option value="TJDF">TJDFT - Distrito Federal</option>
                                <option value="TJES">TJES - Esp√≠rito Santo</option>
                                <option value="TJGO">TJGO - Goi√°s</option>
                                <option value="TJMA">TJMA - Maranh√£o</option>
                                <option value="TJMT">TJMT - Mato Grosso</option>
                                <option value="TJMS">TJMS - Mato Grosso do Sul</option>
                                <option value="TJMG">TJMG - Minas Gerais</option>
                                <option value="TJPA">TJPA - Par√°</option>
                                <option value="TJPB">TJPB - Para√≠ba</option>
                                <option value="TJPR">TJPR - Paran√°</option>
                                <option value="TJPE">TJPE - Pernambuco</option>
                                <option value="TJPI">TJPI - Piau√≠</option>
                                <option value="TJRJ">TJRJ - Rio de Janeiro</option>
                                <option value="TJRN">TJRN - Rio Grande do Norte</option>
                                <option value="TJRS">TJRS - Rio Grande do Sul</option>
                                <option value="TJRO">TJRO - Rond√¥nia</option>
                                <option value="TJRR">TJRR - Roraima</option>
                                <option value="TJSC">TJSC - Santa Catarina</option>
                                <option value="TJSP">TJSP - S√£o Paulo</option>
                                <option value="TJSE">TJSE - Sergipe</option>
                                <option value="TJTO">TJTO - Tocantins</option>
                            </optgroup>
                            <option value="Outro">Outro (Especificar)</option>
                        </select>
                        <input type="text" id="process-court-other" class="form-input mt-2" style="display: none;"
                            placeholder="Especifique o Tribunal...">
                    </div>

                    <!-- √ìRG√ÉO DE TR√ÇNSITO -->
                    <div class="form-group">
                        <label class="form-label">√ìrg√£o de Tr√¢nsito</label>
                        <select id="process-agency" class="form-input" onchange="toggleOtherField('agency')">
                            <option value="">Selecione...</option>
                            <optgroup label="Nacional">
                                <option value="CONTRAN">CONTRAN</option>
                                <option value="DENATRAN">DENATRAN/SENATRAN</option>
                                <option value="PRF">PRF - Pol√≠cia Rodovi√°ria Federal</option>
                                <option value="DNIT">DNIT</option>
                            </optgroup>
                            <optgroup label="Estaduais (DETRAN)">
                                <option value="DETRAN-AC">DETRAN-AC</option>
                                <option value="DETRAN-AL">DETRAN-AL</option>
                                <option value="DETRAN-AP">DETRAN-AP</option>
                                <option value="DETRAN-AM">DETRAN-AM</option>
                                <option value="DETRAN-BA">DETRAN-BA</option>
                                <option value="DETRAN-CE">DETRAN-CE</option>
                                <option value="DETRAN-DF">DETRAN-DF</option>
                                <option value="DETRAN-ES">DETRAN-ES</option>
                                <option value="DETRAN-GO">DETRAN-GO</option>
                                <option value="DETRAN-MA">DETRAN-MA</option>
                                <option value="DETRAN-MT">DETRAN-MT</option>
                                <option value="DETRAN-MS">DETRAN-MS</option>
                                <option value="DETRAN-MG">DETRAN-MG</option>
                                <option value="DETRAN-PA">DETRAN-PA</option>
                                <option value="DETRAN-PB">DETRAN-PB</option>
                                <option value="DETRAN-PR">DETRAN-PR</option>
                                <option value="DETRAN-PE">DETRAN-PE</option>
                                <option value="DETRAN-PI">DETRAN-PI</option>
                                <option value="DETRAN-RJ">DETRAN-RJ</option>
                                <option value="DETRAN-RN">DETRAN-RN</option>
                                <option value="DETRAN-RS">DETRAN-RS</option>
                                <option value="DETRAN-RO">DETRAN-RO</option>
                                <option value="DETRAN-RR">DETRAN-RR</option>
                                <option value="DETRAN-SC">DETRAN-SC</option>
                                <option value="DETRAN-SP">DETRAN-SP</option>
                                <option value="DETRAN-SE">DETRAN-SE</option>
                                <option value="DETRAN-TO">DETRAN-TO</option>
                            </optgroup>
                            <optgroup label="Municipais (Capitais)">
                                <option value="AMC Fortaleza">AMC - Fortaleza</option>
                                <option value="CET S√£o Paulo">CET - S√£o Paulo</option>
                                <option value="CET-Rio">CET-Rio</option>
                                <option value="Transalvador">Transalvador</option>
                                <option value="EPTC Porto Alegre">EPTC - Porto Alegre</option>
                                <option value="BHTrans">BHTrans - Belo Horizonte</option>
                                <option value="Manaustrans">Manaustrans</option>
                            </optgroup>
                            <optgroup label="Outros">
                                <option value="DER">DER - Departamento de Estradas de Rodagem</option>
                                <option value="JARI">JARI (Gen√©rico)</option>
                                <option value="CETRAN">CETRAN (Gen√©rico)</option>
                                <option value="Outro">Outro (Especificar)</option>
                            </optgroup>
                        </select>
                        <input type="text" id="process-agency-other" class="form-input mt-2" style="display: none;"
                            placeholder="Especifique o √ìrg√£o...">
                    </div>

                    <!-- STATUS -->
                    <div class="form-group">
                        <label class="form-label">Status *</label>
                        <select id="process-status" class="form-input" required>
                            <option value="">Selecione...</option>
                            <optgroup label="Aguardando Peti√ß√£o">
                                <option value="Aguardando Peti√ß√£o - Inicial">1.1. Inicial</option>
                                <option value="Aguardando Peti√ß√£o - Defesa">1.2. Defesa</option>
                                <option value="Aguardando Peti√ß√£o - JARI">1.3. JARI</option>
                                <option value="Aguardando Peti√ß√£o - CETRAN">1.4. CETRAN</option>
                                <option value="Aguardando Peti√ß√£o - Recurso Judicial">1.5. Recurso Judicial</option>
                            </optgroup>
                            <optgroup label="Acompanhamento">
                                <option value="Ok Feito">1. Ok Feito</option>
                                <option value="Protocolado">2. Protocolado</option>
                                <option value="Julgado">3. Julgado</option>
                                <option value="Julgado - Improcedente">3.1. Improcedente</option>
                                <option value="Julgado - Procedente">3.2. Procedente</option>
                            </optgroup>
                            <optgroup label="Aguardando Recursos">
                                <option value="Aguardando Recurso Administrativo (JARI)">4. Aguardando Recurso
                                    Administrativo (JARI)</option>
                                <option value="Aguardando Recurso Administrativo (CETRAN)">5. Aguardando Recurso
                                    Administrativo (CETRAN)</option>
                                <option value="Aguardando Recurso Inominado">6. Aguardando Recurso Inominado</option>
                                <option value="Aguardando Agravo de Instrumento">7. Aguardando Agravo de Instrumento
                                </option>
                                <option value="Aguardando Embargos de Declara√ß√£o">8. Aguardando Embargos de Declara√ß√£o
                                </option>
                                <option value="Aguardando Pedido de Uniformiza√ß√£o">9. Aguardando Pedido de Uniformiza√ß√£o
                                </option>
                                <option value="Aguardando Pedido de Autotutela">10. Aguardando Pedido de Autotutela
                                </option>
                                <option value="Aguardando Recurso Extraordin√°rio">11. Aguardando Recurso Extraordin√°rio
                                </option>
                                <option value="Aguardando Cumprimento de Senten√ßa">12. Aguardando Cumprimento de
                                    Senten√ßa</option>
                                <option value="Aguardando Manifesta√ß√£o">13. Aguardando Manifesta√ß√£o</option>
                                <option value="Aguardando Emenda √† Inicial">14. Aguardando Emenda √† Inicial</option>
                                <option value="Aguardando R√©plica √† Contesta√ß√£o">15. Aguardando R√©plica √† Contesta√ß√£o
                                </option>
                                <option value="Aguardando Recurso ao Colegiado da JARI">16. Aguardando Recurso ao
                                    Colegiado da JARI</option>
                            </optgroup>
                            <option value="Arquivado">Arquivado</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Descri√ß√£o</label>
                        <textarea id="process-description" class="form-input" rows="3"></textarea>
                    </div>

                    <!-- CALCULADORA DE PRAZOS INTEGRADA -->
                    <div class="form-group"
                        style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <label class="form-label"
                            style="color: #2d3748; font-weight: 600; margin-bottom: 10px; display: block;">
                            <i class="fas fa-calculator"></i> Calculadora de Prazos
                        </label>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                            <div>
                                <label class="form-label" style="font-size: 0.85rem;">Tipo de Data</label>
                                <select id="deadline-type" class="form-input">
                                    <option value="publicacao">Data da Publica√ß√£o (DJe)</option>
                                    <option value="notificacao">Data da Notifica√ß√£o</option>
                                </select>
                            </div>
                            <div>
                                <label class="form-label" style="font-size: 0.85rem;">Dias √öteis</label>
                                <select id="deadline-days" class="form-input" onchange="calculateProcessDeadline()">
                                    <option value="5">5 Dias</option>
                                    <option value="10">10 Dias</option>
                                    <option value="15">15 Dias</option>
                                    <option value="30">30 Dias</option>
                                </select>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label class="form-label" style="font-size: 0.85rem;">Data Inicial</label>
                                <input type="date" id="deadline-start-date" class="form-input"
                                    onchange="calculateProcessDeadline()">
                            </div>
                            <div>
                                <label class="form-label" style="font-size: 0.85rem;">Prazo Fatal</label>
                                <input type="date" id="process-deadline" class="form-input" readonly
                                    style="background-color: #e2e8f0; font-weight: bold; color: #2d3748;">
                            </div>
                        </div>

                        <div id="deadline-info"
                            style="font-size: 0.8rem; color: #718096; margin-top: 8px; font-style: italic;">
                            A IA buscar√° automaticamente feriados municipais, estaduais e nacionais.
                        </div>

                        <div id="deadline-ai-status" style="margin-top: 8px; display: none;">
                            <div class="text-xs text-blue-600">
                                <i class="fas fa-spinner fa-spin"></i> Buscando feriados e suspens√µes via IA...
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeProcessModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="saveProcess()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- User Modal (Admin Only) -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="user-modal-title">Cadastrar Profissional</h2>
                <button class="modal-close" onclick="closeUserModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="user-form">
                    <input type="hidden" id="user-id">
                    <div class="form-group">
                        <label class="form-label">Nome Completo *</label>
                        <input type="text" id="user-modal-name" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">E-mail *</label>
                        <input type="email" id="user-modal-email" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Perfil *</label>
                        <select id="user-role-select" class="form-input" required>
                            <option value="lawyer">Advogado</option>
                            <option value="admin">Administrador</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telefone</label>
                        <input type="tel" id="user-phone" class="form-input" placeholder="(00) 00000-0000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">OAB/Registro</label>
                        <input type="text" id="user-oab" class="form-input" placeholder="OAB/UF 000000">
                    </div>
                    <div class="form-group" id="user-password-group">
                        <label class="form-label">Senha (deixe em branco para usar padr√£o: advogado2024)</label>
                        <input type="password" id="user-password" class="form-input"
                            placeholder="Digite uma senha personalizada">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeUserModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="saveUser()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="password-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Alterar Senha</h2>
                <button class="modal-close" onclick="closePasswordModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="password-form">
                    <div class="form-group">
                        <label class="form-label">Senha Atual *</label>
                        <input type="password" id="current-password" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nova Senha *</label>
                        <input type="password" id="new-password" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirmar Nova Senha *</label>
                        <input type="password" id="confirm-password" class="form-input" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closePasswordModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="changePassword()">Alterar Senha</button>
            </div>
        </div>
    </div>

    <!-- Attachments Modal -->
    <div id="attachments-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title" id="attachments-modal-title">Anexos do Processo</h2>
                <button class="modal-close" onclick="closeAttachmentsModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="attachments-loading" class="text-center hidden">
                    <div class="loading" style="border-top-color: #667eea; border-right-color: #667eea;"></div>
                </div>

                <div id="attachments-list" class="attachments-list">
                    <!-- Javascript populates -->
                </div>

                <div id="attachments-empty" class="empty-state hidden" style="padding: 20px;">
                    <div style="font-size: 2rem; color: #cbd5e0; margin-bottom: 10px;"><i
                            class="fas fa-file-upload"></i></div>
                    <p>Nenhum arquivo anexado</p>
                </div>

                <div class="upload-area">
                    <h3 style="font-size: 1rem; margin-bottom: 15px; color: #4a5568;">Adicionar Novo Arquivo</h3>
                    <form id="upload-form" class="flex-row gap-10">
                        <input type="file" id="attachment-file" class="form-input" style="padding: 8px;" required>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-upload"></i> Enviar
                        </button>
                    </form>
                    <div id="upload-progress" class="hidden"
                        style="margin-top: 10px; color: #4299e1; font-weight: 600; font-size: 0.9rem;">
                        <i class="fas fa-spinner fa-spin"></i> Enviando arquivo...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="change-password-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Alterar Senha</h2>
                <button class="modal-close" onclick="closeChangePasswordModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="change-password-form">
                    <div class="form-group">
                        <label class="form-label">Senha Atual *</label>
                        <input type="password" id="current-password" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nova Senha *</label>
                        <input type="password" id="new-password" class="form-input" required minlength="6">
                        <small style="color: #718096;">M√≠nimo de 6 caracteres</small>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirmar Nova Senha *</label>
                        <input type="password" id="confirm-password" class="form-input" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeChangePasswordModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="submitPasswordChange()">Alterar Senha</button>
            </div>
        </div>
    </div>

    <script src="js/crm-app.js?v=4.1"></script>
    <script src="js/crm-users.js?v=4.1"></script>
    <script src="js/crm-deadline-alerts.js?v=4.1"></script>
    <script src="js/crm-deadline-calculator.js?v=4.1"></script>
    <script src="js/crm-process-view.js?v=4.1"></script>
    <script src="js/crm-clickable-items.js?v=4.1"></script>
</body>

</html>